 # 典型要素

* Convex Hull Trick
* DPの高速化

# 解法

CHTを適用するために配るDPでなく貰うDPをする。 $dp[i]$ を計算するとき、i未満であるjそれぞれについての $dp[j] + (h[i]-h[j])^2 + c$ のうち最小値を知りたい。

これを直接 $h[i]$ の関数 $f_j(x) = dp[j] + (x-h[j])^2 + c$ とすると二次関数となってCHTが使えないが、異なる $f_j$ 同士の差は $x^2 + c$ が打ち消されて一次関数的に変化する( $f_j(x)$ の最小をつくるjを調べるためには $x^2$ は無視できる)ことに着目すると、 $f'_j(x) = dp[j] -2 \cdot h[j] \cdot x + h[j]^2$ を管理すればよいことが分かる。
