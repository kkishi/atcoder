# 典型要素

グリッド経路数え上げ

# 解法

N行M+1列のグリッド上の経路の数え上げに帰着する。具体的には、最初の行のどこか(0, *)から最後の行のどこか(N-1, *)に移動する経路を数え上げる。

以下の移動をN-1回繰り返すこととなる。

* 右にx_i回動く。ただし、`x_i%3!=0`。
* 下に1回動く。

例えば、サンプル1の(1, 3, 4)は以下の経路に帰着される。

* (0, 1)から開始する。(a_0 = 1)
* 右に2回、下に1回移動し(1, 3)へ行く。(a_1 = 3)
* 右に1回、下に1回移動し(2, 4)へ行く。(a_2 = 4)

さらに`x_i = 1 + y_i + z_i * 3`と分解する。`0 <= y_i <= 1`, `0 <= z_i`であることに注意。ここで`sum(y_i) = Y`と`sum(z_i) = Z`を固定すると、経路数は`H(N-1,Z) * C(N-1,Y)`のようになる（N-1回の移動でZとYを使い切るため）。

それぞれのZについて、(0, 0)から開始して(N-1, *)に移動する方法をまとめて数え上げる。ここで(N-1, c)に移動するような経路を(M+1-c)倍すると、(0, *)から開始する事と対応する（開始位置を右にいくつかずらせると考える）。途中の計算で`i*C(N-1,0) + (i-1)*C(N-1,1) + ... + 0*C(N-1, i)`という式が必要となるが、これは累積和で計算できる。
