## 解法

### 座標圧縮してDP (main.cc)

ある区間に含まれる点をLISの一部として使用する場合、その区間をRまで使い切るのが明らかに最適なので、各区間のRにおいて「そこを右端とする最長のLIS」についての情報を管理するDPをする。セグメント木を二つ使用する。

一つ目のセグメント木は、以下のように「新たな区間のL未満が右端となる」ような場合に対応する。これは単純にLISの長さを管理すればよい。

```
                              R
                              │
                              │
                              │
                              │
                              │
                              L
                    o
                    │
                    │
          o         │
          │         │
o         │         │
│         │         │
│         │
│         │
          │
          │
          │
          │
```

二つ目のセグメント木は、以下のように「新たな区間のL以上R未満が右端となる」ような場合に対応する。これは「LISの長さ-R」を管理することで新たな区間に連結した際にどれだけ良くなるか分かる。


```
                             R
                             │
                    o        │
                    │        │
          o         │        │
          │         │        │
o         │         │        │
│         │                  L
│         │
│         │
          │
          │
          │
          │
```

### 区間をsetで管理 (main_set.cc)

最適なLISを（重なりの無い）区間の集合として管理する。可能な限り左に詰め、余った分を右に加えることを繰り返せばよい。

```
LIS (長さ3の区間4つからなり、合計長は12):
───     ───   ───   ───

新しい区間 (長さ8):
  ────────

新しいLIS (合計長は12のままだが、前に詰められた):
──────────           ──
```
